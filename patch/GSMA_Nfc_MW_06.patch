From 3d9a1861603841aa29f6b1ca780620832134d374 Mon Sep 17 00:00:00 2001
From: Nikhil Chhabra <nikhil.chhabra@nxp.com>
Date: Wed, 12 Sep 2018 15:45:24 +0530
Subject: [PATCH 20/20] [artf607919]SDM855/SN100 : GSMA : 15.9.3.1.2 -
 Permission Issue for the application

---
 src/com/android/nfc/NfcService.java | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/com/android/nfc/NfcService.java b/src/com/android/nfc/NfcService.java
index 0375b66..c471b7c 100755
--- a/src/com/android/nfc/NfcService.java
+++ b/src/com/android/nfc/NfcService.java
@@ -765,7 +765,10 @@ public class NfcService implements DeviceHostListener {
         synchronized (this) {
             mNfcEventInstalledPackages.clear();
             for (int i = 0; i < packagesNfcEvents.size(); i++) {
-                mNfcEventInstalledPackages.add(packagesNfcEvents.get(i).packageName);
+               int hasPerm = pm.checkPermission(android.Manifest.permission.NFC, packagesNfcEvents.get(i).packageName);
+               if (hasPerm == PackageManager.PERMISSION_GRANTED){
+                     mNfcEventInstalledPackages.add(packagesNfcEvents.get(i).packageName);
+               }
             }
         }
     }
-- 
2.7.4

